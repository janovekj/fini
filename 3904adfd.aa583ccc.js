(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{65:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return r})),t.d(n,"metadata",(function(){return c})),t.d(n,"rightToc",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(2),i=t(6),o=(t(0),t(76)),r={title:"Implementing a basic machine"},c={unversionedId:"step-by-step/implementing-a-basic-machine",id:"step-by-step/implementing-a-basic-machine",isDocsHomePage:!1,title:"Implementing a basic machine",description:"We'll import the useMachine hook, and give it LoginMachine as a type argument, and an empty object which we'll expand shortly:",source:"@site/docs/step-by-step/implementing-a-basic-machine.md",slug:"/step-by-step/implementing-a-basic-machine",permalink:"/step-by-step/implementing-a-basic-machine",editUrl:"https://github.com/janovekj/fini/edit/gh-pages/website/docs/step-by-step/implementing-a-basic-machine.md",version:"current",sidebar:"docs",previous:{title:"Defining the schema",permalink:"/step-by-step/defining-the-schema"},next:{title:"States and side-effects",permalink:"/step-by-step/states-and-side-effects"}},s=[],l={rightToc:s};function p(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(o.b)("p",null,"We'll import the ",Object(o.b)("inlineCode",{parentName:"p"},"useMachine")," hook, and give it ",Object(o.b)("inlineCode",{parentName:"p"},"LoginMachine")," as a type argument, and an empty object which we'll expand shortly:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),'import { Machine, State, useMachine } from "fini";\n\u2248\ntype LoginMachine = Machine<\n  {\n    input: State<{\n      changeEmail: string;\n      changePassword: string;\n    }>;\n  },\n  { email: string; password: string }\n>;\n\nconst LoginComponent = () => {\n  const loginMachine = useMachine<LoginMachine>({});\n};\n')),Object(o.b)("p",null,"To keep TypeScript from complaining too much, I also like to provide the initial values right away:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),'const loginMachine = useMachine<LoginMachine>(\n  {},\n  {\n    state: "input",\n    context: {\n      email: "",\n      password: "",\n    },\n  }\n);\n')),Object(o.b)("p",null,"Tip: If it weren't for ",Object(o.b)("inlineCode",{parentName:"p"},"email")," and ",Object(o.b)("inlineCode",{parentName:"p"},"password")," being required, we could just have passed in ",Object(o.b)("inlineCode",{parentName:"p"},'"input"')," as a shorthand, instead of an entire object."),Object(o.b)("p",null,"Next we'll add the ",Object(o.b)("inlineCode",{parentName:"p"},"input")," state and the ",Object(o.b)("inlineCode",{parentName:"p"},"changeEmail")," event handler:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),'const loginMachine = useMachine<LoginMachine>(\n  {\n    input: {\n      changeEmail: (machine, payload) => ({\n        state: "input",\n        context: {\n          ...machine.context,\n          email: payload,\n        },\n      }),\n    },\n  },\n  {\n    state: "input",\n    context: {\n      email: "",\n      password: "",\n    },\n  }\n);\n')),Object(o.b)("p",null,"As you can see, ",Object(o.b)("inlineCode",{parentName:"p"},"changeEmail")," accepts a function where two parameters are provided:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"machine")," is an object containing the current context, as well as some other things that we'll cover later"),Object(o.b)("li",{parentName:"ol"},Object(o.b)("inlineCode",{parentName:"li"},"payload"),", which is the value being passed along with the event. It is of the same type as the one defined on the state's event in our schema")),Object(o.b)("p",null,"The purpose of the function is to return the next state. In our case, we're not actually going into a new state - we're only updating the context. For cases like this, Fini allows you to simply just return the updated context object directly, instead of explicitly specifying what state we're in:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),'const loginMachine = useMachine<LoginMachine>(\n  {\n    input: {\n      changeEmail: (machine, payload) => ({\n        ...machine.context,\n        email: payload,\n      }),\n    },\n  },\n  {\n    state: "input",\n    context: {\n      email: "",\n      password: "",\n    },\n  }\n);\n')),Object(o.b)("p",null,"Let's add the ",Object(o.b)("inlineCode",{parentName:"p"},"changePassword")," event handler as well (and make things a bit more readably, while we're at it):"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),'const loginMachine = useMachine<LoginMachine>(\n  {\n    input: {\n      changeEmail: ({ context }, email) => ({\n        ...context,\n        email,\n      }),\n      changePassword: ({ context }, password) => ({\n        ...context,\n        password,\n      }),\n    },\n  },\n  {\n    state: "input",\n    context: {\n      email: "",\n      password: "",\n    },\n  }\n);\n')),Object(o.b)("p",null,"Let's also quickly hook it up with some input fields so we can see how interacting with the machine works:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-tsx"}),"const LoginComponent = () => {\n  const loginMachine = useMachine<LoginMachine>(...)\n\n  return <div>\n    <input\n      value={loginMachine.context.email}\n      onChange={event => loginMachine.changeEmail(event.target.value)}\n    />\n    <input\n      value={loginMachine.context.password}\n      onChange={event => loginMachine.changePassword(event.target.value)}\n    />\n  </div>\n}\n")),Object(o.b)("p",null,"Now, I know what you're probably thinking: ",Object(o.b)("em",{parentName:"p"},"all this code for a couple of inputs?! \ud83e\udd2f")),Object(o.b)("p",null,"And you would be right for thinking it. However, now that we have covered the basics from schema to implementation, we're getting ready to finish the rest of our schema, and hopefully start showing the parts where all this typing pays off!"))}p.isMDXComponent=!0},76:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return m}));var a=t(0),i=t.n(a);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=i.a.createContext({}),p=function(e){var n=i.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},u=function(e){var n=p(e.components);return i.a.createElement(l.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},h=i.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,r=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(t),h=a,m=u["".concat(r,".").concat(h)]||u[h]||b[h]||o;return t?i.a.createElement(m,c(c({ref:n},l),{},{components:t})):i.a.createElement(m,c({ref:n},l))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,r=new Array(o);r[0]=h;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,r[1]=c;for(var l=2;l<o;l++)r[l]=t[l];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,t)}h.displayName="MDXCreateElement"}}]);